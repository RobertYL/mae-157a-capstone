%% sim main body
initialize_sim

i = 0;
while(t(i) < T_max) %& waypoint_pass < 0)
    r_err = r_d(:,t) - R_T(:,t);
    v_err = v_d(:,t) - V_T(:,t);
    
    u = A_T(:,t) - Kp*r_err - Kd*v_err + g;
    if abs(u) > 4       % check for max input cap
       u = 4; 
    end
    torque = control_law(u);
end